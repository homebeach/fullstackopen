{"ast":null,"code":"import _toConsumableArray from\"/Volumes/Storage/fullstackopen/osa3/3.11-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Volumes/Storage/fullstackopen/osa3/3.11-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import PersonForm from'./PersonForm';import Numbers from'./Numbers';import Filter from'./Filter';import noteService from'./services/notes';import'./index.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),persons=_useState2[0],setPersons=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),note=_useState4[0],setNote=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState(persons),_useState8=_slicedToArray(_useState7,2),filteredPersons=_useState8[0],setFilteredPersons=_useState8[1];var fetchData=function fetchData(){noteService.getAll().then(function(response){setPersons(response.data);setFilteredPersons(response.data);});};useEffect(function(){fetchData();},[]);function displayNoteWithTimeout(message){setNote(/*#__PURE__*/_jsx(\"div\",{className:\"note\",children:message}));setTimeout(function(){return setNote('');},5000);}function displayErrorWithTimeout(message){setError(/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:message}));setTimeout(function(){return setError('');},5000);fetchData();}var addPerson=function addPerson(person){var existingPerson=isNameAlreadyExists(person.content);if(existingPerson){if(window.confirm(\"\".concat(existingPerson.content,\" is already added to phonebook, replace the old phone number?\"))){noteService.update(existingPerson.id,person).then(function(response){fetchData();displayNoteWithTimeout(\"\".concat(person.content,\" number was changed.\"));}).catch(function(error){displayErrorWithTimeout(\"\".concat(person.content,\" was already deleted from server\"));});}}else{var newPersons=[].concat(_toConsumableArray(persons),[person]);noteService.create(person).then(function(response){fetchData();displayNoteWithTimeout(\"\".concat(person.content,\" succesfully added to phonebook.\"));});}};var isNameAlreadyExists=function isNameAlreadyExists(content){return persons.find(function(person){return person.content===content;});};var handleDeleteButtonClick=function handleDeleteButtonClick(event,id,name){event.preventDefault();// Prevents the form submission and page reload\nif(window.confirm(\"Do you really want to delete '\".concat(name,\"'?\"))){noteService.remove(id).then(function(response){noteService.getAll().then(function(updatedPersons){fetchData();displayNoteWithTimeout(\"\".concat(name,\" was deleted.\"));});});}};return/*#__PURE__*/_jsxs(\"div\",{children:[error,note,/*#__PURE__*/_jsx(\"h2\",{children:\"Phonebook\"}),/*#__PURE__*/_jsx(Filter,{persons:persons,setFilteredPersons:setFilteredPersons}),/*#__PURE__*/_jsx(PersonForm,{addPerson:addPerson,isNameAlreadyExists:isNameAlreadyExists}),/*#__PURE__*/_jsx(Numbers,{filteredPersons:filteredPersons,handleDeleteButtonClick:handleDeleteButtonClick})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","PersonForm","Numbers","Filter","noteService","jsx","_jsx","jsxs","_jsxs","App","_useState","_useState2","_slicedToArray","persons","setPersons","_useState3","_useState4","note","setNote","_useState5","_useState6","error","setError","_useState7","_useState8","filteredPersons","setFilteredPersons","fetchData","getAll","then","response","data","displayNoteWithTimeout","message","className","children","setTimeout","displayErrorWithTimeout","addPerson","person","existingPerson","isNameAlreadyExists","content","window","confirm","concat","update","id","catch","newPersons","_toConsumableArray","create","find","handleDeleteButtonClick","event","name","preventDefault","remove","updatedPersons"],"sources":["/Volumes/Storage/fullstackopen/osa3/3.11-frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport PersonForm from './PersonForm';\nimport Numbers from './Numbers';\nimport Filter from './Filter';\nimport noteService from './services/notes'\nimport './index.css'\n\nconst App = () => {\n  const [persons, setPersons] = useState([]);\n  const [note, setNote] = useState(\"\");\n  const [error, setError] = useState(\"\");\n  const [filteredPersons, setFilteredPersons] = useState(persons);\n\n  const fetchData = () => {\n    noteService\n      .getAll()\n      .then(response => {\n        setPersons(response.data);\n        setFilteredPersons(response.data);\n      })\n  };\n  \n  useEffect(() => {\n    fetchData();\n  }, []);\n\n\n  function displayNoteWithTimeout(message) {\n    setNote(<div className=\"note\">{message}</div>);\n    setTimeout(() => setNote(''), 5000);\n  }\n\n  function displayErrorWithTimeout(message) {\n    setError(<div className=\"error\">{message}</div>);\n    setTimeout(() => setError(''), 5000);\n    fetchData();\n  }\n\n  const addPerson = (person) => {\n\n    const existingPerson = isNameAlreadyExists(person.content);\n\n    if (existingPerson) {\n\n      if (window.confirm(`${existingPerson.content} is already added to phonebook, replace the old phone number?`)) {        \n        noteService\n        .update(existingPerson.id, person)\n        .then(response => {\n          fetchData();\n          displayNoteWithTimeout(`${person.content} number was changed.`);\n        })\n        .catch(error => {\n          displayErrorWithTimeout(`${person.content} was already deleted from server`)\n        })\n      }\n\n    } else {\n      const newPersons = [...persons, person];\n      noteService\n      .create(person)\n      .then(response => {\n        fetchData();\n        displayNoteWithTimeout(`${person.content} succesfully added to phonebook.`);\n      })\n    }\n  };\n\n  const isNameAlreadyExists = (content) => {\n    return persons.find((person) => person.content === content);\n  };\n\n  const handleDeleteButtonClick = (event, id, name) => {\n    event.preventDefault(); // Prevents the form submission and page reload\n\n    if (window.confirm(`Do you really want to delete '${name}'?`)) {\n      noteService\n      .remove(id)\n      .then(response => {\n        noteService.getAll().then(updatedPersons => {\n          fetchData();\n          displayNoteWithTimeout(`${name} was deleted.`);\n        });\n      });\n    }\n  };\n\n  return (\n    <div>\n      {error}\n      {note} \n      <h2>Phonebook</h2>\n      <Filter persons={persons} setFilteredPersons={setFilteredPersons} />\n      <PersonForm addPerson={addPerson} isNameAlreadyExists={isNameAlreadyExists} />\n      <Numbers filteredPersons={filteredPersons} handleDeleteButtonClick={handleDeleteButtonClick}/> \n    </div>\n  );\n};\n\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}